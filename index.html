<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–î–æ–Ω–∞—Ç –Ω–∞ –ª–∏–º–æ–Ω–∞–¥</title>
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
</head>

<body>
    <div class="container mt-5">
        <div class="row">
            <div class="col-md-12">
                <h2 class="text-center">–î–æ–Ω–∞—Ç –Ω–∞ –õ–∏–º–æ–Ω–∞–¥ üçã</h2>
                <div class="card mt-4">
                    <div class="card-header">
                        <h4>–õ–∏–º–æ–Ω–∞–¥–Ω–æ–≥–æ –±–∞–ª–∞–Ω—Å–∞ —Ö–≤–∞—Ç–∏—Ç –Ω–∞</h4>
                    </div>
                    <div class="card-body">
                        <p id="balance" class="display-4 text-center">0 ü•§</p>
                        <p id="balance-note" class="text-center">ü•§ –æ–±–æ–∑–Ω–∞—á–∞–µ—Ç –≥—Ä–∞—Ñ–∏–Ω</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="row mt-4">
            <div class="col-md-6 offset-md-3">
                <div class="card">
                    <div class="card-header">
                        <h4>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–ª—è –¥–æ–Ω–∞—Ç–∞</h4>
                    </div>
                    <div class="card-body">
                        <table class="table">
                            <tbody>
                                <tr>
                                    <td>–ü–µ—Ä–µ–≤–æ–¥ –ø–æ –Ω–æ–º–µ—Ä—É</td>
                                    <td><span id="phone-number"
                                            onclick="copyToClipboard('+79773444105')">+79773444105</span></td>
                                </tr>
                                <tr>
                                    <td>–ë–∞–Ω–∫</td>
                                    <td>
                                        <svg width="40" height="27" fill="none" xmlns="http://www.w3.org/2000/svg"
                                            viewBox="0 0 500 320" class="lsp-159vm6z">
                                            <path
                                                d="M284.49,10C201.05,10,134,77.5,134,160c0,83.18,67.71,150,150.47,150S435,242.5,435,160,367.25,10,284.49,10Zm0,205.91c-30.78,0-56.08-25.23-56.08-55.91s25.3-55.91,56.08-55.91,56.09,25.23,56.09,55.91C339.89,190.68,315.27,215.91,284.49,215.91Z"
                                                class="brand" fill="#8B3FFD"></path>
                                            <path d="M134,53.58V271.76H80.68L12.28,53.58Z" class="brand" fill="#8B3FFD">
                                            </path>
                                        </svg>–Æ–º–∞–Ω–∏
                                    </td>
                                </tr>
                                <tr>
                                    <td>–ü–æ–ª—É—á–∞—Ç–µ–ª—å</td>
                                    <td>–ú–∏–ª–æ–≤–∞–Ω–æ–≤ –ú.–ò.</td>
                                </tr>
                            </tbody>
                        </table>
                        <p class="text-center">–ü–æ—Å–ª–µ –ø–µ—Ä–µ–≤–æ–¥–∞ –ª–∏–º–æ–Ω–∞–¥–Ω—ã–π –±–∞–ª–∞–Ω—Å –ø–æ–ø–æ–ª–Ω–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const pantryUrl = 'https://getpantry.cloud/apiv1/pantry/ad586b77-0421-459c-a631-ffc793bf770f/basket/donat-na-lomonad';
            const myApiUrl = 'https://script.google.com/macros/s/AKfycbxguYebQbigqifFXtAaq_Q_Fo2FfQ0SPLhhk-bmnKFjEvkbCS0aHnUS9zS5z3UpB0Sa/exec';

            fetch(pantryUrl)
                .then(response => response.json())
                .then(data => {
                    // Update balance and history with pantryUrl data
                    updatePage(data);
                    // Check myApi for updated data
                    fetch(myApiUrl)
                        .then(response => response.json())
                        .then(newData => {
                            // Compare data with pantryUrl
                            if (!isEqual(data, newData)) {
                                // If data is different, update page with myApi data
                                updatePage(newData);
                            }
                        })
                        .catch(error => {
                            console.error('Error fetching data from myApi:', error);
                        });
                })
                .catch(error => {
                    document.getElementById('balance').innerText = 'Failed to load balance.';
                    console.error('Error fetching data from pantryUrl:', error);
                });

            function updatePage(data) {
                // Update balance
                document.getElementById('balance').innerText = Math.round(data.balance / 200 * 10) / 10 + ' ü•§';
                // Add note about the symbol
                document.getElementById('balance-note').innerText = 'ü•§ –æ–±–æ–∑–Ω–∞—á–∞–µ—Ç –≥—Ä–∞—Ñ–∏–Ω';
            }

            function isEqual(data1, data2) {
                // Compare balance and history arrays
                return JSON.stringify(data1) === JSON.stringify(data2);
            }
        });

        function copyToClipboard(text) {
            const tempInput = document.createElement('input');
            tempInput.value = text;
            document.body.appendChild(tempInput);
            tempInput.select();
            document.execCommand('copy');
            document.body.removeChild(tempInput);
            alert('–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω: ' + text);
        }
    </script>
</body>

</html>
